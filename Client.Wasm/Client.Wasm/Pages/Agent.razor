@attribute [Authorize]
@page "/agent"
@inject Client.Wasm.Services.IAgentApiClient AgentClient

<MudCard Class="rounded-xl shadow-lg glass-effect p-6">
    <MudCardHeader>
        <MudText Typo="Typo.h6" Class="mb-4">AI Агент</MudText>
    </MudCardHeader>
    <MudCardContent>
        <EditForm Model="@request" OnValidSubmit="Send">
            <MudTextField Lines="6" @bind-Value="request.Text" Placeholder="Введите заявление или вопрос" Class="w-100 mb-4" />
            <MudButton Color="Color.Primary" Variant="Variant.Filled" Type="Submit">Отправить</MudButton>
        </EditForm>
        @if (response != null)
        {
            <div class="mt-4 p-6 rounded-xl shadow-lg bg-white">
                <pre>@System.Text.Json.JsonSerializer.Serialize(response, new System.Text.Json.JsonSerializerOptions { WriteIndented = true })</pre>
            </div>
        }
    </MudCardContent>
</MudCard>

@code {
    Client.Wasm.DTOs.DocumentClassifyFormDto request = new();
    Client.Wasm.DTOs.DocumentClassificationResultDto? response;

    private async Task Send()
    {
        response = await AgentClient.AnalyzeAsync(request);
    }
}
