@attribute [Authorize]
@page "/agent"
@inject Client.Wasm.Services.IAgentApiClient AgentClient

<MudCard Class="rounded-xl shadow-lg glass-effect p-6">
    <MudCardHeader>
        <MudText Typo="Typo.h6" Class="mb-4">AI Агент</MudText>
    </MudCardHeader>
    <MudCardContent>
        <EditForm Model="@request" OnValidSubmit="Send">
            <DataAnnotationsValidator />
            <ValidationSummary />
            <MudTextField Lines="6" @bind-Value="request.Text" Placeholder="Введите заявление или вопрос" Class="w-100 mb-4" />
            <MudButton Color="Color.Primary" Variant="Variant.Filled" Type="Submit">Отправить</MudButton>
        </EditForm>
        @if (!string.IsNullOrEmpty(response))
        {
            <div class="mt-4 p-6 rounded-xl shadow-lg bg-white">
                <p>@response</p>
            </div>
        }
    </MudCardContent>
</MudCard>

@code {
    Client.Wasm.DTOs.AgentRequestDto request = new();
    string? response;

    private async Task Send()
    {
        var res = await AgentClient.AnalyzeAsync(request);
        response = res.Result;
    }
}
